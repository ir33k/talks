<meta charset="utf-8">

<p></p>

<script>
  /*
   * To avoid animation running faster on high refresh rate screens we
   * need to control fps (frames per seconds).  To achieve that we can
   * use timestamp provided as first argument in callback function
   * passed to window.requestAnimationFrame.
   *
   * With that we can update any value on each frame.  This example
   * increments value of counter on each frame.
   */

  const element = document.querySelector('p')
  const fps = 30
  let lastTime = 0, counter = 0

  function animationLoop (timestamp) {
    if (timestamp - lastTime >= 1000 / fps) {
      lastTime = timestamp
      counter++
      element.textContent = `counter: ${counter}`
    }

    window.requestAnimationFrame(animationLoop)
  }

  window.requestAnimationFrame(animationLoop)
</script>

